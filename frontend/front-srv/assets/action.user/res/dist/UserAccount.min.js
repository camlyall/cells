(()=>{"use strict";var e={566:e=>{e.exports=require("create-react-class")},455:e=>{e.exports=require("material-ui")},757:e=>{e.exports=require("pydio")},610:e=>{e.exports=require("pydio/http/resources-manager")},815:e=>{e.exports=require("pydio/util/xml")},689:e=>{e.exports=require("react")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{r.r(n),r.d(n,{Callbacks:()=>rt,Directory:()=>Qe,ModalAddressBook:()=>Ae,ModalDashboard:()=>_e,PasswordForm:()=>v,WelcomeModal:()=>et});var e=r(610),t=r(689),o=r.n(t),i=r(757),a=r.n(i);const s=require("pydio/http/api");var u=r.n(s);const c=require("cells-sdk");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function m(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}var h=a().requireLib("form").ValidPassword,g=a().requireLib("hoc").ModernTextField,v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(s,e);var t,r,n,i,a=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(n);if(i){var r=y(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(this,e)});function s(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return m(d(e=a.call.apply(a,[this].concat(r))),"state",{error:null,old:"",newPass:""}),m(d(e),"getMessage",(function(t){return e.props.pydio.MessageHash[t]})),m(d(e),"update",(function(t,r){var n={};n[r]=t,e.setState(n,(function(){var t=e.validate();e.props.onValidStatusChange&&e.props.onValidStatusChange(t)}))})),m(d(e),"validate",(function(){if(!e.state.validStatus)return!1;var t=e.state,r=t.oldPass,n=t.newPass;return r&&n?n.length<parseInt(e.props.pydio.getPluginConfigs("core.auth").get("PASSWORD_MINLENGTH"))?(e.setState({error:e.getMessage(378)}),!1):(e.setState({error:null}),!0):(e.setState({error:e.getMessage(239)}),!1)})),m(d(e),"post",(function(t){var r=e.state,n=r.oldPass,o=r.newPass,i=e.props.pydio,a="";i.user.lock&&(a=" "+e.getMessage(445)),i.user.getIdmUser().then((function(r){var s=c.IdmUser.constructFromObject(JSON.parse(JSON.stringify(r)));s.OldPassword=n,s.Password=o,new c.UserServiceApi(u().getRestClient()).putUser(s.Login,s).then((function(){i.displayMessage("SUCCESS",e.getMessage(197)+a),t(!0),a&&i.getController().fireAction("logout")}))}))})),e}return t=s,(r=[{key:"render",value:function(){var e=this;if(!this.props.pydio.user)return null;var t,r=this.props.pydio.MessageHash;return this.state.error?t=o().createElement("div",{className:"error"},this.state.error):this.props.pydio.user.lock&&(t=o().createElement("div",null,r[444])),o().createElement("div",{style:this.props.style},t,o().createElement("div",null,o().createElement("form",{autoComplete:"off"},o().createElement(g,{onChange:function(t,r){e.update(r,"oldPass")},type:"password",value:this.state.oldPass,floatingLabelText:r[237],autoComplete:"off",variant:"v2",fullWidth:!0}))),o().createElement("div",null,o().createElement(h,{onChange:function(t,r){e.update(t,"newPass")},attributes:{name:"pass",label:r[198],direction:"column"},value:this.state.newPass,name:"newpassword",onValidStatusChange:function(t){return e.setState({validStatus:t})},variant:"v2"})))}}])&&p(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(o().Component);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==O(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===O(o)?o:String(o)),n)}var o}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var P=r(689),j=r(455),_=j.FlatButton,C=j.Divider,T=r(757).requireLib("hoc").ThemedContainers.Popover,I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(n);if(o){var r=S(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,e,t)).state={passOpen:!1,passValid:!1,passAnchor:null},r}return t=a,(r=[{key:"passOpenPopover",value:function(e){this.setState({passOpen:!0,passAnchor:e.currentTarget})}},{key:"passClosePopover",value:function(){this.setState({passOpen:!1})}},{key:"passValidStatusChange",value:function(e){this.setState({passValid:e})}},{key:"passSubmit",value:function(){this.refs.passwordForm.post(function(e){e&&this.passClosePopover()}.bind(this))}},{key:"render",value:function(){var e=this.props.pydio,t=this.state,r=t.passOpen,n=t.passAnchor,o=t.passValid;return P.createElement("div",{style:{marginLeft:8}},P.createElement(_,{onClick:this.passOpenPopover.bind(this),label:e.MessageHash[194],secondary:!0}),P.createElement(T,{open:r,anchorEl:n,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"bottom"},onRequestClose:this.passClosePopover.bind(this),zDepth:4},P.createElement("div",null,P.createElement("div",{style:{padding:"15px 15px 0",fontSize:15}},e.MessageHash[194]),P.createElement(v,{style:{width:386,padding:10,paddingBottom:30},pydio:e,ref:"passwordForm",onValidStatusChange:this.passValidStatusChange.bind(this)}),P.createElement(C,null),P.createElement("div",{style:{textAlign:"right",padding:"8px 0"}},P.createElement(_,{label:e.MessageHash[54],onClick:this.passClosePopover.bind(this)}),P.createElement(_,{disabled:!o,label:"Ok",onClick:this.passSubmit.bind(this)})))))}}])&&E(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(P.Component);const x=require("prop-types");var R=r.n(x);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function F(e){var t=function(e,t){if("object"!==M(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===M(t)?t:String(t)}function B(e,t){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},B(e,t)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var U=r(689).Component,H=r(455),q=H.Toggle,V=H.Subheader,W=H.MenuItem,Y=H.SelectField,z=H.TextField,Q=H.TimePicker,X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(n);if(o){var r=L(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"onChange",value:function(e){var t=this.props,r=t.values;(0,t.onChange)(N(N({},r),e),!0)}},{key:"onFrequencyChange",value:function(e){var t,r={NOTIFICATIONS_EMAIL_FREQUENCY:e};switch(e){case"M":t="5";break;case"H":t="2";break;case"D1":t="03";break;case"D2":t="09,14";break;case"W1":t="Monday"}r.NOTIFICATIONS_EMAIL_FREQUENCY_USER=t,this.onChange(r)}},{key:"onPickDate",value:function(e,t,r){var n=this.props.values.NOTIFICATIONS_EMAIL_FREQUENCY_USER.split(","),o=[];"first"===e&&(o=[r.getHours(),n[1]?n[1]:"00"]),"last"===e&&(o=[n[0]?n[0]:"00",r.getHours()]),this.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:o.join(",")})}},{key:"render",value:function(){var e,t=this,r=this.props,n=r.definitions,o=r.values,i=r.pydio,a=function(e){return i.MessageHash["user_dash."+e]},s=o.NOTIFICATIONS_EMAIL_GET,u=o.NOTIFICATIONS_EMAIL_FREQUENCY,c=o.NOTIFICATIONS_EMAIL_FREQUENCY_USER,l=(o.NOTIFICATIONS_EMAIL,o.NOTIFICATIONS_EMAIL_SEND_HTML),p="true"===s,f=new Map,d=[];if(n[1].choices.split(",").map((function(e){var t=e.split("|");f.set(t[0],t[1]),d.push(React.createElement(W,{primaryText:t[1],value:t[0]}))})),p)switch(u){case"M":case"H":e=React.createElement(z,{fullWidth:!0,floatingLabelText:a("M"===u?62:63),value:c,onChange:function(e,r){t.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:r})}});break;case"D1":var y=new Date;y.setHours(c),y.setMinutes(0),e=React.createElement(Q,{format:"ampm",hintText:a(64),value:y,onChange:function(e,r){t.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:r.getHours()})},autoOk:!0,textFieldStyle:{width:"100%"}});break;case"D2":var m=c+"";m||(m="09,14"),m=m.split(",");var b=new Date,h=new Date;h.setMinutes(0),b.setHours(m[0]),b.setMinutes(0),m[1]&&h.setHours(m[1]),e=React.createElement("div",{style:{display:"flex"}},React.createElement(Q,{format:"ampm",hintText:a(65),value:b,onChange:this.onPickDate.bind(this,"first"),textFieldStyle:{width:100,marginRight:5}}),React.createElement(Q,{format:"ampm",hintText:a(66),value:h,onChange:this.onPickDate.bind(this,"last"),textFieldStyle:{width:100,marginLeft:5}}));break;case"W1":e=React.createElement(Y,{floatingLabelText:a(67),fullWidth:!0,value:c,onChange:function(e,r,n){t.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:n})}},React.createElement(W,{primaryText:a(68),value:"Monday"}),React.createElement(W,{primaryText:a(69),value:"Tuesday"}),React.createElement(W,{primaryText:a(70),value:"Wednesday"}),React.createElement(W,{primaryText:a(71),value:"Thursday"}),React.createElement(W,{primaryText:a(72),value:"Friday"}),React.createElement(W,{primaryText:a(73),value:"Saturday"}),React.createElement(W,{primaryText:a(74),value:"Sunday"}))}return React.createElement("div",null,React.createElement(V,{style:{paddingLeft:20}},a(61)),React.createElement("div",{style:{padding:"0 20px 20px"}},React.createElement(q,{label:n[0].label,toggled:"true"===s,onToggle:function(e,r){t.onChange({NOTIFICATIONS_EMAIL_GET:r?"true":"false"})}}),p&&React.createElement("div",{style:{paddingBottom:16}},React.createElement("div",{style:{padding:"16px 0"}},React.createElement(q,{label:n[4].label,toggled:"true"===l,onToggle:function(e,r){t.onChange({NOTIFICATIONS_EMAIL_SEND_HTML:r?"true":"false"})}})),React.createElement(Y,{fullWidth:!0,floatingLabelText:n[1].label,value:u,onChange:function(e,r,n){t.onFrequencyChange(n)}},d),e)))}}])&&D(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(U);X.propTypes={definitions:R().object,values:R().object,onChange:R().func};const J=require("pydio/util/lang");var G=r.n(J),K=r(455);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ae(n.key),n)}}function re(e,t){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},re(e,t)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}function ie(e,t,r){return(t=ae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ae(e){var t=function(e,t){if("object"!==Z(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Z(t)?t:String(t)}var se=a().requireLib("form"),ue=se.Manager,ce=se.FormPanel,le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(s,e);var t,r,n,i,a=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(n);if(i){var r=oe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ne(e)}(this,e)});function s(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),ie(ne(t=a.call(this,e)),"onFormChange",(function(e,r,n){var o=t.state.values;t.setState({dirty:r,values:e},(function(){t._updater&&t._updater(t.getButtons()),(t.props.saveOnChange||e.avatar!==o.avatar)&&t.saveForm()}))})),ie(ne(t),"getButtons",(function(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return n&&(t._updater=n),t.state.dirty?(r=o().createElement(K.FlatButton,{label:t.props.pydio.MessageHash[628],onClick:t.revert}),e=o().createElement(K.FlatButton,{label:t.props.pydio.MessageHash[53],secondary:!0,onClick:t.saveForm})):e=o().createElement(K.FlatButton,{label:t.props.pydio.MessageHash[86],onClick:t.props.onDismiss}),t.props.pydio.Controller.getActionByName("pass_change")?[o().createElement("div",{style:{display:"flex",width:"100%"}},o().createElement(I,t.props),o().createElement("span",{style:{flex:1}}),r,e)]:[e]})),ie(ne(t),"revert",(function(){t.setState({values:ee({},t.state.originalValues),dirty:!1},(function(){t._updater&&t._updater(t.getButtons())}))})),ie(ne(t),"saveForm",(function(){if(t.state.dirty){var e=t.props.pydio,r=t.state,n=r.definitions,o=r.values;e.user.getIdmUser().then((function(r){r.Attributes||(r.Attributes={}),n.forEach((function(e){o[e.name]?"user"===e.scope?r.Attributes[e.name]=o[e.name]:r.Attributes["parameter:"+e.pluginId+":"+e.name]=JSON.stringify(o[e.name]):delete r.Attributes[e.name]}));var i=!1;return o.lang&&o.lang!==e.currentLanguage&&(e.user.setPreference("lang",o.lang),i=!0),new c.UserServiceApi(u().getRestClient()).putUser(r.Login,r).then((function(r){i&&e.observeOnce("registry_loaded",(function(){t.setState({definitions:ue.parseParameters(e.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and not(contains(@name, 'NOTIFICATIONS_EMAIL'))]"),mailDefinitions:ue.parseParameters(e.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and contains(@name, 'NOTIFICATIONS_EMAIL')]")})})),e.refreshUserData(),t.setState({dirty:!1},(function(){t._updater&&t._updater(t.getButtons())}))}))}))}else t.setState({dirty:!1})}));var r={},n=e.pydio;n.user&&n.user.preferences.forEach((function(e,t){"gui_preferences"!==t&&(r[t]=e)}));var i=ue.parseParameters(n.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and not(contains(@name, 'NOTIFICATIONS_EMAIL'))]"),l=ue.parseParameters(n.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and contains(@name, 'NOTIFICATIONS_EMAIL')]");return t.state={definitions:i,mailDefinitions:l,values:r,originalValues:G().deepCopy(r),dirty:!1},t}return t=s,(r=[{key:"render",value:function(){var e=this.props,t=e.pydio,r=e.miniDisplay,n=e.style;if(!t.user)return null;var i=this.state,a=i.definitions,s=i.values;return r&&(a=a.filter((function(e){return-1!==["avatar"].indexOf(e.name)}))),a=a.map((function(e){return ee(ee({},e),{},{label:e.label+" - "+e.description})})),o().createElement("div",{style:n},o().createElement(ce,{className:"current-user-edit",parameters:a,values:s,depth:-1,binary_context:"user_id="+t.user.id+(s.avatar?"?"+s.avatar:""),onChange:this.onFormChange,variant:"v2"}),o().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:" \n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group:first-of-type {\n  margin-top: 210px;\n  overflow-y: hidden;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 200px;\n}\n.react-mui-context .current-user-edit.pydio-form-panel .form-entry-image>div:last-child {\n  margin-top: 0;\n}\n\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image > div:first-child {\n  padding: 0;\n  border-radius: 0;\n  background-color: transparent !important;  \n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .image-label,\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .form-legend {\n  display: none;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .file-dropzone {\n  border-radius: 50%;\n  width: 160px !important;\n  height: 160px !important;\n  margin: 20px auto;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .binary-remove-button {\n  position: absolute;\n  bottom: 5px;\n  right: 5px;\n  font-size: 14px; \n}\n\n"}}))}}])&&te(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(o().Component),pe=r(815);const fe=require("material-ui/styles");function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},de.apply(this,arguments)}var ye=r(689),me=r(566),be=r(757).requireLib("boot"),he=be.ActionDialogMixin,ge=be.SubmitButtonProviderMixin,ve=be.AsyncComponent,Oe=r(455),Ee=Oe.Tabs,we=Oe.Tab,Se=Oe.FontIcon,Pe=Oe.FlatButton,je=Oe.Paper,_e=me({displayName:"ModalDashboard",mixins:[he,ge],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"md",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},getDefaultButtons:function(){return[ye.createElement(Pe,{label:this.props.pydio.MessageHash[86],onClick:this.props.onDismiss})]},getButtons:function(e){return this._updater=e,this.refs.profile?this.refs.profile.getButtons(this._updater):this.getDefaultButtons()},onTabChange:function(e){this._updater&&(e&&this.refs[e]&&this.refs[e].getButtons?this._updater(this.refs[e].getButtons(this._updater)):this._updater(this.getDefaultButtons()))},render:function(){var e={textTransform:"none"},t=[ye.createElement(we,{key:"account",label:this.props.pydio.MessageHash["user_dash.43"],icon:ye.createElement(Se,{className:"mdi mdi-account"}),buttonStyle:e,value:"profile"},ye.createElement(le,de({},this.props,{ref:"profile"})))];return function(e){return pe.XPathSelectNodes(e.getXmlRegistry(),'client_configs/component_config[@component="UserAccountTabs"]/additional_tab').map((function(e){return{id:e.getAttribute("id"),tabInfo:JSON.parse(e.getAttribute("tabInfo")),paneInfo:JSON.parse(e.getAttribute("paneInfo"))}}))}(this.props.pydio).map(function(r){t.push(ye.createElement(we,{key:r.id,label:this.props.pydio.MessageHash[r.tabInfo.label],icon:ye.createElement(Se,{className:r.tabInfo.icon}),buttonStyle:e,value:r.id},ye.createElement(ve,de({ref:r.id},this.props,r.paneInfo))))}.bind(this)),1===t.length?ye.createElement("div",{style:{width:"100%",overflowY:"auto",minHeight:350}},ye.createElement(le,de({},this.props,{ref:"profile",style:{position:"relative",width:"100%"}}))):ye.createElement(je,{style:{width:"100%",overflow:"hidden",borderBottomRightRadius:0,borderBottomLeftRadius:0},zDepth:0},ye.createElement(Ee,{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},tabItemContainerStyle:{minHeight:72},contentContainerStyle:{overflowY:"auto",minHeight:350},onChange:this.onTabChange},t))}});function Ce(){return Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ce.apply(this,arguments)}var Te=r(689),Ie=r(566),xe=r(757),Re=xe.requireLib("boot").ActionDialogMixin,Me=xe.requireLib("components").AddressBook,Ae=Ie({displayName:"ModalAddressBook",mixins:[Re],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"xl",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this,t=this.props.pydio;return Te.createElement(Me,Ce({mode:"book"},this.props,{style:{width:"100%",flex:1,height:"auto"},closeButton:Te.createElement(K.IconButton,{iconClassName:"mdi mdi-close",tooltip:t.MessageHash[86],onClick:function(){return e.dismiss()},style:{marginRight:10}})}))}});function Ne(e){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(e)}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ke.apply(this,arguments)}function De(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?De(Object(r),!0).forEach((function(t){Be(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Be(e,t,r){return(t=Ue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ue(n.key),n)}}function Ue(e){var t=function(e,t){if("object"!==Ne(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ne(t)?t:String(t)}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},He(e,t)}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}var Ve=Pydio.requireLib("workspaces").MasterLayout,We=Pydio.requireLib("components"),Ye=We.DirectoryLayout,ze=(We.ListStylesCompact,function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}(s,e);var t,r,n,i,a=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qe(n);if(i){var r=qe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return t=s,(r=[{key:"render",value:function(){var e=this,t=this.props,r=t.pydio,n=t.muiTheme.buildFSTemplate({}),i={style:Fe({},n.leftPanel.masterStyle),headerHeight:72,onMouseOver:function(){},userWidgetProps:{mergeButtonInAvatar:!0,popoverDirection:"left",actionBarStyle:{marginTop:0},style:{height:72,display:"flex",alignItems:"center",boxShadow:"none",background:"transparent"}}};return o().createElement(Ve,{pydio:r,classes:["vertical_fit","react-fs-template","directory-template"],style:Fe({},n.masterStyle),leftPanelProps:i,drawerOpen:!1,onCloseDrawerRequested:function(){e.setState({drawerOpen:!1})}},o().createElement(Ye,ke({},this.props,{style:{width:"100%",flex:1,flexGrow:1,height:"100%"}})))}}])&&Le(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(o().Component));const Qe=ze=(0,fe.muiThemeable)()(ze);var Xe=r(566),Je=r.n(Xe);function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ge.apply(this,arguments)}var Ke=a().requireLib("boot"),Ze=Ke.ActionDialogMixin,$e=Ke.CancelButtonProviderMixin;Ke.SubmitButtonProviderMixin;const et=Je()({displayName:"WelcomeModal",mixins:[Ze,$e],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogSize:"sm",dialogPadding:0}},close:function(e){this.props.onRequestStart&&this.props.onRequestStart(e),this.props.onDismiss()},getMessage:function(e){return this.props.pydio.MessageHash["ajax_gui.tour.welcomemodal."+e]},getButtons:function(){var e=this;return[o().createElement(K.FlatButton,{label:this.getMessage("skip"),onClick:function(){e.close(!0)}}),o().createElement(K.FlatButton,{label:this.getMessage("start"),primary:!0,onClick:function(){return e.close(!1)}})]},render:function(){return o().createElement("div",null,o().createElement("div",{style:{position:"relative",width:"100%",height:200,overflow:"hidden"}},o().createElement(le,Ge({miniDisplay:!0},this.props,{saveOnChange:!0}))),o().createElement(K.CardTitle,{title:this.getMessage("title"),subtitle:this.getMessage("subtitle")}))}});var tt,rt=(tt=window.pydio,{openDashboard:function(){e.loadClassesAndApply(["PydioForm"],(function(){tt.UI.openComponentInModal("UserAccount","ModalDashboard")}))},openAddressBook:function(){e.loadClassesAndApply(["PydioForm","PydioComponents"],(function(){tt.UI.openComponentInModal("UserAccount","ModalAddressBook")}))}})})(),window.UserAccount=n})();